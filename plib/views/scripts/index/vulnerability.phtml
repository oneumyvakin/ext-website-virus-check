<?php
// Copyright 1999-2017. Parallels IP Holdings GmbH.
?>
<?php echo $this->renderTabs($this->tabs); ?>
<?php

echo '<h3>' . $this->title . '</h3>';

?>

<?php
    if ($this->vulnerabilitiesReport['Error']['IsError']) {
        echo '<h4>' . pm_Locale::lmsg('scannerErrorDomainError') . '</h4>';
        echo pm_Locale::lmsg($this->vulnerabilitiesReport['Error']['LocaleKey'], $this->vulnerabilitiesReport['Error']['LocaleArgs']);
    }

    foreach ($this->vulnerabilitiesReport['vulnerabilities'] as $vulnId => $vuln) {

        echo '<h4><a target="_blank" href="'.$vuln['AdvisoryURL'].'">' . $vuln['Title'] . '</a></h4>';

        if ($vuln['Error']['IsError']) {
            echo '<div class="form-row">';
            echo '<div class="field-name"><label>' . pm_Locale::lmsg('vulnerabilityError') . '</label></div>';
            echo '<div class="field-value"><label>' . pm_Locale::lmsg($vuln['Error']['LocaleKey'], $vuln['Error']['LocaleArgs']) . '<br>' . pm_Locale::lmsg('vulnerabilityErrorSubmitIssue') . '</label></div>';
            echo '</div>';
            echo '<br>';
            continue;
        }

        echo '<div class="form-row">';
        echo '<div class="field-name"><label>' . pm_Locale::lmsg('vulnerabilityCve') . '</label></div>';
        echo '<div class="field-value"><label>' . $vuln['CVE'] . '</label></div>';
        echo '</div>';

        echo '<div class="form-row">';
        echo '<div class="field-name"><label>' . pm_Locale::lmsg('vulnerabilityAdvisoryDate') . '</label></div>';
        echo '<div class="field-value"><label>' . $vuln['AdvisoryDate'] . '</label></div>';
        echo '</div>';

        echo '<div class="form-row">';
        echo '<div class="field-name"><label>' . pm_Locale::lmsg('vulnerabilityAdvisoryUrl') . '</label></div>';
        echo '<div class="field-value"><label><a target="_blank" href="'.$vuln['AdvisoryURL'].'">' . $vuln['AdvisoryURL'] . '</a></label></div>';
        echo '</div>';

        echo '<div class="form-row">';
        echo '<div class="field-name"><label>' . pm_Locale::lmsg('vulnerabilitySoftwareType') . '</label></div>';
        echo '<div class="field-value"><label>' . $vuln['SoftwareType'] . '</label></div>';
        echo '</div>';

        echo '<div class="form-row">';
        echo '<div class="field-name"><label>' . pm_Locale::lmsg('vulnerabilitySoftwareName') . '</label></div>';
        echo '<div class="field-value"><label>' . $vuln['SoftwareName'] . '</label></div>';
        echo '</div>';

        echo '<div class="form-row">';
        echo '<div class="field-name"><label>' . pm_Locale::lmsg('vulnerabilitySoftwareVersion') . '</label></div>';
        echo '<div class="field-value"><label>' . $vuln['SoftwareVersion'] . '</label></div>';
        echo '</div>';

        echo '<div class="form-row">';
        echo '<div class="field-name"><label>' . pm_Locale::lmsg('vulnerabilityPath') . '</label></div>';
        echo '<div class="field-value"><label>' . $vuln['Path'] . '</label></div>';
        echo '</div>';

        echo '<br>';
    }

?>
